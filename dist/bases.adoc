:source-highlighter: highlightjs
:revealjs_theme: black
:revealjs_progress: true
:revealjs_slideNumber: true
:revealjs_history: true
:revealjs_showNotes: false
:revealjs_width: 1080
:imagesdir: images
:customcss: css/custom.css

== History

* 2011 - Created by JetBrain
* 2016 - 1.0
* 2017 - First-class support for Kotlin on Android
* 2021 - 1.6

[NOTE.speaker]
--
You found an Android developper? He know Kotlin
--
== Why

* Fast (at least as fast as Java).
* 100% Interoperability with Java.
* Concise and expressive code.

[NOTE.speaker]
--
Exclude Scala compilation too slow and complex
--

[%notitle]
[transition=fade-in]
== Class

image:java.png[width=30]
[source,java]
----
public class Pony {
    private String name;

    public Pony(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }
}
----

image:kotlin.png[width=30]
[source,kotlin]
[.hideCode]
----
class Pony(val name: String) {

}
----

[%notitle]
[transition=fade-in]
== Class

image:java.png[width=30]
[source,java]
----
public class Pony {
    private String name;

    public Pony(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }
}
----

image:kotlin.png[width=30]
[source,kotlin]
----
class Pony                   {
    
}
----

[NOTE.speaker]
--
Public by default
--

[%notitle]
[transition=fade-in]
== Class

image:java.png[width=30]
[source,java]
----
public class Pony {
    private String name;

    public Pony(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }
}
----

image:kotlin.png[width=30]
[source,kotlin]
----
class Pony(var name: String) {
    
}
----

[NOTE.speaker]
--
type after the name because the name is more important
--


[%notitle]
[transition=fade-in]
== Class

image:java.png[width=30]
[source,java]
----
public class Pony {
    private final String name;

    public Pony(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }
}
----

image:kotlin.png[width=30]
[source,kotlin]
----
class Pony(val name: String) {
    
}
----

[NOTE.speaker]
--
immutable? it's val
--


[%notitle]
[transition=fade-in]
== Class

image:java.png[width=30]
[source,java]
----
public class Pony {
    private final String name;

    public Pony(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }
}
----
[source,java]
----
new Pony("Rainbow Dash");
----

image:kotlin.png[width=30]
[source,kotlin]
----
class Pony(val name: String)
----
[source,java, step=1]
----
Pony("Rainbow Dash")
----

[NOTE.speaker]
--
no new
curly braces optional as the semicolumn
--

[transition=fade-in]
== Data class

image:java.png[width=30]
[source,java]
----
public record Pony(String name) {
}
----

image:kotlin.png[width=30]
[source,kotlin,step=1]
----
data class Pony(val name: String)
----

[NOTE.speaker]
--
curly braces optional as the semicolumn
--


[%notitle]
== Sucre

image:sucre.jpg[]

[transition=fade-in]
== Data class

image:java.png[width=30]
[source,java]
----
public record Pony(String name) {
}
----

image:kotlin.png[width=30]
[source,kotlin]
----
data class Pony(val name: String = "Rainbow Dash")
----

[NOTE.speaker]
--
default parameters
--

[transition=fade-in]
== Default, Named, ...


image:kotlin.png[width=30]
[source,kotlin]
----
data class Pony(
    val id: String,
    val name: String = "Rainbow Dash")
----

[source,kotlin, step=1]
----
val p1 = Pony("123") // Pony(id=123, name=Rainbow Dash)
----
[source,kotlin, step=2]
----
val p2 = Pony(name = "Pinkie", id = "234") // Pony(id=234, name=Pinkie)
----
[source,kotlin, step=3]
----
val p3 = p1.copy(name = "Twilight") // Pony(id=123, name=Twilight)
----
[source,kotlin, step=4]
----
val (id, name) = p1 // id=123 name=Rainbow Dash
----
[source,kotlin, step=5]
----
val (_, name) = p1
----

[NOTE.speaker]
--
default parameters
--

[transition=fade-in]
== Value

image:java.png[width=30]
[source,java]
----
record PonyId(String value) {}
----
[source,java, step=1]
----
record Pony(PonyId id, PonyName name) {}
----

image:kotlin.png[width=30]
[source,kotlin, step=2]
----
@JvmInline
value class PonyId(val id: String)
----

[NOTE.speaker]
--
default parameters
--

[%notitle]
== old

image:old.gif[width=300]

[NOTE.speaker]
--
Tu me montre plein de super chose mais moi j'ai encore du java
--

[transition=slide-in fade-out]
== Calling Kotlin from Java

image:java.png[width=30]
[source,java]
----
var p = new Pony("id", "name");
p.copy("123", p.getName());
p.getId();
----

[NOTE.speaker]
--
Kotlin can call java code but also create java friendly code
It's also possible to generate multiple fuctions for default parameters
--

[transition=fade-in]
== Lambda

image:java.png[width=30]
[source,java]
----
public String doStuff(String name, BiFunction<String, Integer, String> f) {
    return f.apply(name, 42);
}
----

image:kotlin.png[width=30]
[source,kotlin, step=1]
----
fun doStuff(name: String, f: (String, Int) -> String): String {
    return f(name, 42)
}
----

[NOTE.speaker]
--
No need of bifunction wrapper
Function2 under the hood
--

[transition=fade-in]
== Lambda

image:java.png[width=30]
[source,java]
----
public String doStuff(String name, BiFunction<String, Integer, String> f) {
    return f.apply(name, 42);
}
doStuff("name", (a,b) -> a+b);
----

image:kotlin.png[width=30]
[source,kotlin]
----
fun doStuff(name: String, f: (String, Int) -> String): String {
    return f(name, 42)
}
doStuff("name", {a,b -> a + b})
----

[NOTE.speaker]
--
Call are same
--

[transition=fade-in]
== Lambda

image:java.png[width=30]
[source,java]
----
public String doStuff(String name, BiFunction<String, Integer, String> f) {
    return f.apply(name, 42);
}
doStuff("name", (a,b) -> a+b);
----

image:kotlin.png[width=30]
[source,kotlin]
----
fun doStuff(name: String, f: (String, Int) -> String): String {
    return f(name, 42)
}
doStuff("name") {a,b -> a + b}
----

[NOTE.speaker]
--
Lambda last parameter can be extracted
--

[transition=fade-out]
== Lambda Usage

image:java.png[width=30]
[source,java]
----
@Bean
RouterFunction<ServerResponse> routes(PonyHandler ponyHandler) {
    return
            route(GET("/ponies"), ponyHandler::findAll)
                    .and(route(POST("/ponies"), ponyHandler::create))
                    .andNest(path("/{id}"),
                            route(GET("/"), ponyHandler::findOne));
}
----

image:kotlin.png[width=30]
[source,kotlin]
----
@Bean
fun routes(ponyHandler: PonyHandler): RouterFunction<ServerResponse> {
    return route(GET("/ponies"), ponyHandler::findAll)
            .and(route(POST("/ponies"), ponyHandler::create))
            .andNest(path("/{id}"),
                    route(GET("/"), ponyHandler::findOne))
}
----

[NOTE.speaker]
--
Lambda last parameter can be extracted
--

[transition=fade-in]
== Lambda Usage

image:java.png[width=30]
[source,java]
----
@Bean
RouterFunction<ServerResponse> routes(PonyHandler ponyHandler) {
    return
            route(GET("/ponies"), ponyHandler::findAll)
                    .and(route(POST("/ponies"), ponyHandler::create))
                    .andNest(path("/{id}"),
                            route(GET("/"), ponyHandler::findOne));
}
----

image:kotlin.png[width=30]
[source,kotlin]
----
@Bean
fun routes(ponyHandler: PonyHandler): RouterFunction<ServerResponse> {
    return router { 
        "/ponies".nest { 
            GET("", ponyHandler::findAll)
            POST("", ponyHandler::create)
            "/{id}".nest { 
                GET("", ponyHandler::findOne)
            }
        }
    }
}
----

[NOTE.speaker]
--
Usage of lambda as last parameter for DSL
This one is build-in for springboot
--

[transition=fade-in]
== Lambda Usage

image:java.png[width=30]
[source,java]
----
@Bean
RouterFunction<ServerResponse> routes(PonyHandler ponyHandler) {
    return
            route(GET("/ponies"), ponyHandler::findAll)
                    .and(route(POST("/ponies"), ponyHandler::create))
                    .andNest(path("/{id}"),
                            route(GET("/"), ponyHandler::findOne));
}
----

image:kotlin.png[width=30]
[source,kotlin]
----
@Bean
fun routes(ponyHandler: PonyHandler) = router {
    "/ponies".nest {
        GET("", ponyHandler::findAll)
        POST("", ponyHandler::create)
        "/{id}".nest {
            GET("", ponyHandler::findOne)
        }
    }
}
----

[NOTE.speaker]
--
Usage of lambda as last parameter for DSL
This one is build-in for springboot
--

== Sealed

image:java.png[width=30]
[source,java]
----
public sealed interface Pony permits Pegasis, Unicorn {}
public final class Pegasis implements Pony {}
public final class Unicorn implements Pony {}
----

image:kotlin.png[width=30]
[source,kotlin, step=1]
----
sealed interface Pony
class Unicorn: Pony
class Pegasis: Pony
----

[NOTE.speaker]
--
3 files for the sealed in java
--

[transition=fade-in]
== Pattern Matching

image:java.png[width=30]
[source,java]
----
Pony p = aPony();
switch (p) {
    case Unicorn u -> u.doMagic();
    case Pegasis g -> g.fly();
}
----

image:kotlin.png[width=30]
[source,kotlin, step=1]
----
val p = aPony()
when (p) {
    is Unicorn -> p.doMagic()
    is Pegasis -> p.fly()
}
----

[NOTE.speaker]
--
smart cast no new variable
same check on sealed
--

[transition=fade-in]
== Pattern Matching

image:java.png[width=30]
[source,java]
[.hidden]
----
Pony p = aPony();
switch (p) {
    case Unicorn u -> u.doMagic();
    case Pegasis g -> g.fly();
}
----

image:kotlin.png[width=30]
[source,kotlin]
----
val p = aPony()
when (p) {
    is Unicorn -> p.doMagic()
    is Pegasis -> p.fly()
}
----

[NOTE.speaker]
--
Java 17 preview
--

[transition=fade-in]
== Null safty

image:java.png[width=30]
[source,java]
----
public void doStuff(Pony p) {
    if (p == null) {
        throw new RuntimeException("Pony must not be null");
    }
    // stuff
}
----

image:kotlin.png[width=30]
[source,kotlin, step=1]
----
fun doStuff(p: Pony) {


    
    // doStuff
}
----

[transition=fade-in]
== Null safty

image:java.png[width=30]
[source,java]
----
public void doStuff(Pony p) {
    if (p == null) {
        throw new RuntimeException("Pony must not be null");
    }
    // stuff
}
----

image:kotlin.png[width=30]
[source,kotlin]
----
fun doStuff(p: Pony?) {
    if (p == null) {
        throw RuntimeException("Pony must not be null")
    }
    // doStuff with no more nullable p: Pony
}
----

== Extension functions

image:kotlin.png[width=30]
[source,kotlin]
----
fun String.asPony(): Pony = Pony(this)
"Rainbow Dash".toPony()
----

[NOTE.speaker]
--
Add function to external classes

Enchance without modify

Exemple: Domain to DTO mapping
--


== Scope Function Apply

image:java.png[width=30]
[source,java]
----
var builder = new PonyBuilder();
builder.setName("name")
builder.setId("id")
var result = builder.build()
----


image:kotlin.png[width=30]
[source,kotlin, step=1]
----
val result = PonyBuilder().apply {
    id = "id"
    name = "name"
}.build()
----

[NOTE.speaker]
--
easy to read
--

[transition=fade-in]
== Scope Function With

image:java.png[width=30]
[source,java]
----
var name = pony.getName();
var id = pony.getId();
var result = stuff(id, name);
----


image:kotlin.png[width=30]
[source,kotlin, step=1]
----
val (name, id) = pony

val result = stuff(id, name)
----

[NOTE.speaker]
--
if pony is note a dataclass?
--

[transition=fade-in]
== Scope Function With

image:java.png[width=30]
[source,java]
----
var name = pony.getName();
var id = pony.getId();
var result = stuff(id, name);
----


image:kotlin.png[width=30]
[source,kotlin]
----
var result = with(pony) {
  stuff(id, name);
}
----

[NOTE.speaker]
--
Everything is an expression and can be returned
--

== Scope Function 

* let
* with
* run
* apply
* also

[NOTE.speaker]
--
Other available
--

[%notitle]
== woo

image:wooo.jpg[]

== Spring integration

image:spring.init.png[]

[fragement, step=1]
image:spring.doc.png[]

== Spring integration

First class coroutine support

* Webflux
* Mvc
* Data reactive
* Messaging
* Vault

== Spring integration

* router dsl
* security dsl

== Some examples from spring

image:java.png[width=30]
[source,java]
----
public class Application {

	public static JafuApplication app = webApplication(a -> a.beans(b -> b
			.bean(SampleService.class))
			.enable(webMvc(s -> s
					.port(s.profiles().contains("test") ? 8181 : 8080)
					.router(router -> {
						SampleHandler handler = s.ref(SampleHandler.class);
						router
								.GET("/", handler::hello)
								.GET("/api", handler::json);
					}).converters(c -> c
							.string()
							.jackson()))));

	public static void main (String[] args) {
		app.run(args);
	}
}
----

== Some examples from spring

image:java.png[width=30]
[source,java]
----
val app = webApplication {
	beans {
		bean<SampleService>()
	}
	webMvc {
		port = if (profiles.contains("test")) 8181 else 8080
		router {
			val service = ref<SampleService>()
			GET("/") {
				ok().body(service.generateMessage())
			}
			GET("/api") {
				ok().body(Sample(service.generateMessage()))
			}
		}
		converters {
			string()
			jackson {
				indentOutput = true
			}
		}
	}
}
----
